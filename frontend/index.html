<!DOCTYPE html>
<html lang="vi" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Weather Forecast VN</title>

  <!-- Leaflet -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>

  <!-- Icon set -->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/remixicon@4.3.0/fonts/remixicon.css"
  />

  <!-- CSS Chính -->
  <link rel="stylesheet" href="style.css" />
  <!-- CSS cho Panel Cảnh báo mới -->
  <link rel="stylesheet" href="alerts.css" />
</head>

<body>
  <!-- TOP BAR (Giữ nguyên như file cũ) -->
  <header class="topbar">
    <div class="topbar-left">
      <div class="brand">
        <span class="brand-icon">☁</span>
        <span class="brand-text">VN WEATHER</span>
      </div>

      <nav class="topbar-nav">
        <button class="nav-btn" data-page="home">
          <i class="ri-home-4-line"></i>
          <span>Home</span>
        </button>
        <button class="nav-btn" data-page="alerts">
          <i class="ri-map-2-line"></i>
          <span>Cảnh báo</span>
        </button>
        <button class="nav-btn" data-page="notify">
          <i class="ri-notification-3-line"></i>
          <span>Thông báo</span>
        </button>
        <button class="nav-btn" data-page="info">
          <i class="ri-information-line"></i>
          <span>Thông tin chung</span>
        </button>
      </nav>
    </div>

    <div class="search-box">
      <i class="ri-search-line"></i>
      <input id="search-input" type="text" placeholder="Tìm địa điểm, tỉnh/thành..." />
      <button id="btn-gps" class="gps-btn" type="button" title="Định vị vị trí hiện tại">
        <i class="ri-crosshair-2-line"></i>
      </button>
    </div>
  </header>

  <!-- MAIN -->
  <main class="app-main">

    <!-- MAP PAGE -->
    <section class="map-wrapper" id="page-map">
      <div id="map"></div>

      <!-- FLOATING TOOLBAR -->
      <div class="map-floating right">
        <button class="float-btn" id="btn-layer-temp">
          <i class="ri-temp-hot-line"></i>
        </button>
        <button class="float-btn" id="btn-layer-rain">
          <i class="ri-rainy-line"></i>
        </button>
        <button class="float-btn" id="btn-layer-wind">
          <i class="ri-windy-line"></i>
        </button>
        <button class="float-btn" id="btn-my-location">
          <i class="ri-focus-3-line"></i>
        </button>
      </div>

      <!-- WEATHER DETAIL (Giữ nguyên như file cũ) -->
      <div class="weather-detail" id="weather-detail">
        <div class="detail-header">
          <span id="detail-location">Chọn một điểm trên bản đồ</span>
          <button id="detail-close"><i class="ri-close-line"></i></button>
        </div>
        <div class="detail-body">
          <div class="detail-row">
            <span>Thời gian:</span>
            <strong id="detail-time">--</strong>
          </div>
          <div class="detail-row">
            <span>Nhiệt độ:</span>
            <strong id="detail-temp">--</strong>
          </div>
          <div class="detail-row">
            <span>Lượng mưa:</span>
            <strong id="detail-rain">--</strong>
          </div>
          <div class="detail-row">
            <span>Gió:</span>
            <strong id="detail-wind">--</strong>
          </div>
          <div class="detail-row">
            <span>Hướng gió:</span>
            <strong id="detail-wind-dir">--</strong>
          </div>
          <div class="detail-row">
            <span>Độ ẩm:</span>
            <strong id="detail-rh">--</strong>
          </div>
          <div class="detail-row">
            <span>Mây:</span>
            <strong id="detail-cloud">--</strong>
          </div>
          <div class="detail-row">
            <span>Áp suất bề mặt:</span>
            <strong id="detail-pressure">--</strong>
          </div>
          <div class="detail-row">
            <span>Tọa độ click:</span>
            <strong id="detail-coord">--</strong>
          </div>
          <div class="detail-row">
            <span>Điểm gần nhất:</span>
            <strong id="detail-nearest">--</strong>
          </div>
        </div>
        <!-- Nút kích hoạt panel cảnh báo (tùy chọn xử lý JS) -->
        <div class="obs-panel-footer">
          <button id="btn-obs-alert" class="obs-alert-btn" type="button">
            Cảnh báo chi tiết
          </button>
        </div>
      </div>

      <!-- TIMESERIES PANEL (Giữ nguyên như file cũ) -->
      <div class="weather-timeseries" id="timeseries-panel" style="display:none;">
        <div class="ts-header">
          <span id="ts-location-name"></span>
          <span id="ts-status" style="margin-left:6px;font-size:12px;color:#666"></span>
        </div>

        <div id="ts-summary" style="font-size:13px;margin-top:4px;"></div>

        <div class="ts-chart-block">
          <div class="ts-label">Nhiệt độ (°C)</div>
          <canvas id="ts-temp" width="320" height="80"></canvas>
        </div>

        <div class="ts-chart-block">
          <div class="ts-label">Tốc độ gió (m/s)</div>
          <canvas id="ts-wind" width="320" height="80"></canvas>
        </div>

        <div class="ts-chart-block">
          <div class="ts-label">Lượng mưa (mm)</div>
          <canvas id="ts-rain" width="320" height="60"></canvas>
        </div>
      </div>
    </section>

    <!-- HOME PAGE -->
    <section class="page-panel" id="page-home">
      <div class="page-panel-header">
        <h1>Tổng quan thời tiết Việt Nam</h1>
        <button class="page-close" data-close-page="home">
          <i class="ri-close-line"></i>
        </button>
      </div>
      <p>Hiển thị vài số liệu tổng quan...</p>
    </section>

    <!-- ALERTS PAGE (TRANG CẢNH BÁO LỚN - Giữ nguyên như file cũ) -->
    <section class="page-panel" id="page-alerts">
      <div class="page-panel-header">
        <h1>Cảnh báo thời tiết</h1>
        <button class="page-close" data-close-page="alerts">
          <i class="ri-close-line"></i>
        </button>
      </div>

      <div class="alerts-container">
        <!-- CARD: THỜI TIẾT HÔM NAY -->
        <div class="alert-today-card">
          <div class="alert-today-header">
            <span class="alert-today-title">Thời tiết hôm nay</span>
            <span class="alert-today-date" id="alert-today-date"></span>
          </div>
          <div class="alert-today-body">
            <p class="alert-today-line" id="alert-today-line1"></p>
            <p class="alert-today-line" id="alert-today-line2"></p>
          </div>
        </div>

        <!-- CARD: THỜI TIẾT HIỆN TẠI -->
        <div class="alert-current-card">
          <div class="alert-current-header">
            <span class="alert-current-title">Thời tiết hiện tại</span>
            <span class="alert-current-time" id="alert-current-time"></span>
          </div>

          <div class="alert-current-body">
            <div class="alert-current-left">
              <div class="alert-icon-placeholder">
                <i class="ri-cloudy-2-line"></i>
              </div>
              <div class="alert-temp-main">
                <span id="alert-temp-value"></span>
                <span class="alert-temp-unit">°C</span>
              </div>
              <div class="alert-temp-feel">
                RealFeel® <span id="alert-temp-feel"></span>
              </div>
              <div class="alert-condition" id="alert-condition"></div>
              <button class="alert-more-btn" type="button">
                CHI TIẾT THÊM
              </button>
            </div>

            <div class="alert-current-right">
              <div class="alert-metric-row">
                <span>RealFeel Shade™</span>
                <span id="alert-shade"></span>
              </div>
              <div class="alert-metric-row">
                <span>Gió</span>
                <span id="alert-wind"></span>
              </div>
              <div class="alert-metric-row">
                <span>Gió giật mạnh</span>
                <span id="alert-gust"></span>
              </div>
              <div class="alert-metric-row">
                <span>Chất lượng không khí</span>
                <span id="alert-aqi" class="alert-aqi-good"></span>
              </div>
            </div>
          </div>
        </div>
        <div class="alerts-list" id="alerts-list">
          <!-- JS render danh sách cảnh báo -->
        </div>
      </div>
    </section>

    <!-- NOTIFY PAGE -->
    <section class="page-panel" id="page-notify">
      <div class="page-panel-header">
        <h1>Thông báo & Cảnh báo</h1>
        <button class="page-close" data-close-page="notify">
          <i class="ri-close-line"></i>
        </button>
      </div>

      <div class="notify-filter">
        <button class="active">Tất cả</button>
        <button>Cảnh báo</button>
        <button>Tin tức</button>
      </div>

      <div class="notify-content-wrapper">
        <div class="notify-group-label">Mới nhất</div>
        <ul class="notify-list" id="notify-list">
          <li class="notify-item type-danger unread">
            <div class="notify-icon"><i class="ri-alert-fill"></i></div>
            <div class="notify-body">
              <div class="notify-title">Cảnh báo Mưa lớn & Dông</div>
              <div class="notify-desc">Khu vực Bắc Bộ có mưa rào và dông...</div>
              <div class="notify-meta">
                <span><i class="ri-time-line"></i> 10 phút trước</span>
                <a href="#" class="notify-action">Xem trên bản đồ</a>
              </div>
            </div>
          </li>
          <li class="notify-item type-warning">
            <div class="notify-icon"><i class="ri-fire-fill"></i></div>
            <div class="notify-body">
              <div class="notify-title">Nắng nóng diện rộng</div>
              <div class="notify-desc">Nhiệt độ Hà Nội chạm ngưỡng 38°C...</div>
              <div class="notify-meta">
                <span><i class="ri-time-line"></i> 1 giờ trước</span>
              </div>
            </div>
          </li>
        </ul>
        <div class="notify-group-label">Hôm qua</div>
        <ul class="notify-list">
          <li class="notify-item type-system">
            <div class="notify-icon"><i class="ri-database-2-line"></i></div>
            <div class="notify-body">
              <div class="notify-title">Đồng bộ dữ liệu vệ tinh</div>
              <div class="notify-desc">Hệ thống đã cập nhật dữ liệu mây và gió...</div>
              <div class="notify-meta">
                <span><i class="ri-time-line"></i> 1 ngày trước</span>
              </div>
            </div>
          </li>
        </ul>
      </div>
    </section>

    <!-- INFO PAGE -->
    <section class="page-panel" id="page-info">
      <div class="page-panel-header">
        <h1>Thông tin dự án</h1>
        <button class="page-close" data-close-page="info">
          <i class="ri-close-line"></i>
        </button>
      </div>

      <div class="info-scroll-content">
        <div class="info-brand">
          <div class="info-logo-icon"><i class="ri-cloud-windy-line"></i></div>
          <h2 class="project-name">VN Weather Forecast</h2>
          <p class="project-version">Phiên bản Beta 1.0.2</p>
        </div>

        <div class="info-block">
          <h3><i class="ri-article-line"></i> Giới thiệu</h3>
          <p>Hệ thống hỗ trợ giám sát và dự báo thời tiết...</p>
        </div>

        <div class="info-block">
          <h3><i class="ri-function-line"></i> Tính năng nổi bật</h3>
          <ul class="info-feature-list">
            <li><i class="ri-check-double-line"></i> Trực quan hóa dữ liệu Leaflet.</li>
            <li><i class="ri-check-double-line"></i> Theo dõi thời gian thực.</li>
            <li><i class="ri-check-double-line"></i> Biểu đồ biến thiên 48h.</li>
            <li><i class="ri-check-double-line"></i> Hệ thống cảnh báo sớm.</li>
          </ul>
        </div>

        <div class="info-block">
          <h3><i class="ri-code-s-slash-line"></i> Công nghệ sử dụng</h3>
          <div class="tech-tags">
            <span class="tag-tech">HTML5/CSS3</span>
            <span class="tag-tech">JavaScript (ES6)</span>
            <span class="tag-tech">Leaflet.js</span>
            <span class="tag-tech">OpenWeatherMap API</span>
            <span class="tag-tech">NodeJS Backend</span>
          </div>
        </div>

        <hr class="info-divider">

        <div class="info-block team-block">
          <h3><i class="ri-group-line"></i> Đội ngũ thực hiện</h3>
          <div class="team-role">Giảng viên hướng dẫn:</div>
          <div class="team-member highlight">TS. Nguyễn Đình Hóa</div>
          <div class="team-role mt-2">Sinh viên thực hiện:</div>
          <ul class="student-list">
            <li>1. Nguyễn Xuân Hiếu - B21DCVT019</li>
            <li>2. Nguyễn Tuấn Huy - B21DCVT025</li>
            <li>3. Ngọ Đức Duy - B21DCVT161</li>
          </ul>
        </div>
        <div class="info-footer">
          &copy; 2025 VN Weather Project. All rights reserved.
        </div>
      </div>
    </section>
  </main>

  <!-- TIMEBAR (Giữ nguyên) -->
  <div id="timebar" class="timebar">
    <div class="timebar-header">
      <span id="timebar-current-label">Hôm nay • --:--</span>
      <span id="timebar-range-label">--</span>
    </div>
    <div class="timebar-slider-row">
      <span id="timebar-start-label" class="timebar-edge-label">--</span>
      <input
        type="range"
        id="timebar-slider"
        min="0"
        max="0"
        step="1"
        value="0"
      />
      <span id="timebar-end-label" class="timebar-edge-label">--</span>
    </div>
  </div>

  <!-- === PANEL CẢNH BÁO SIDEBAR (MỚI THÊM) === -->
  <div id="alert-panel" class="alert-panel hidden">
    <div class="alert-header">
      <span class="alert-title">Cảnh báo & Chi tiết</span>
      <button id="alert-close"><i class="ri-close-line"></i></button>
    </div>

    <!-- Demo Section 1 -->
    <div class="alert-section">
      <h3>Dự báo hôm nay (Demo)</h3>
      <div class="alert-today-line">Trời nhiều mây, có mưa rào nhẹ.</div>
      <div class="alert-today-line">Độ ẩm: <strong>85%</strong> - Tầm nhìn: <strong>8km</strong></div>
      <div class="alert-today-line" style="color: #dc2626; margin-top: 4px;">
        <i class="ri-alarm-warning-fill"></i> Cảnh báo dông lốc cấp 1
      </div>
    </div>

    <!-- Demo Section 2 -->
    <div class="alert-section">
      <h3>Thời tiết hiện tại</h3>
      <div class="alert-current-temp">28°C</div>
      
      <div class="alert-meta-row">
        <div class="alert-meta-col">
          <div class="alert-meta-label">Cảm giác như</div>
          <div class="alert-meta-value">32°C</div>
        </div>
        <div class="alert-meta-col">
          <div class="alert-meta-label">Gió</div>
          <div class="alert-meta-value">ĐN 15 km/h</div>
        </div>
      </div>

      <div class="alert-meta-row">
        <div class="alert-meta-col">
          <div class="alert-meta-label">UV Index</div>
          <div class="alert-meta-value">Cao (7)</div>
        </div>
        <div class="alert-meta-col">
          <div class="alert-meta-label">Áp suất</div>
          <div class="alert-meta-value">1008 hPa</div>
        </div>
      </div>
    </div>

    <!-- Dynamic content target -->
    <div id="alert-dynamic-content"></div>
  </div>

  <!-- SCRIPTS -->
  <script src="config.js"></script>
  <script src="data.js"></script>
  <script src="colors.js"></script>
  <script src="legend.js"></script>
  <script src="layers.js"></script>
  <script src="layers_rain.js"></script>
  <script src="layers_wind.js"></script>
  <script src="wind_config.js"></script>
  <script src="wind_field.js"></script>
  <script src="wind_canvas_layer.js"></script>
  <script src="wind_particle_layer.js"></script>
  <script src="wind_controls.js"></script>
  <script src="api.js"></script>
  <script src="map.js"></script>
  <script src="ui.js"></script>
  <script src="alerts.js"></script>
  <script src="main.js"></script>
  <script src="timebar.js"></script>

</body>
</html>
