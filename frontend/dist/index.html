<!DOCTYPE html>
<html lang="vi" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Weather Forecast VN</title>
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>

    <style>:root {
  --brand: #ef4444;
  --header-h: 64px;
  --bg: #ffffff;
  --panel: #ffffff;
  --text: #0f172a;
  --muted: #64748b;
  --border: #e5e7eb;
  --chip-bg: #f3f4f6;
  --shadow: 0 10px 30px rgba(0, 0, 0, 0.12);
}
html[data-theme="dark"] {
  --bg: #0b1220;
  --panel: #111827;
  --text: #e5e7eb;
  --muted: #94a3b8;
  --border: #1f2937;
  --chip-bg: #0f172a;
  --shadow: 0 10px 40px rgba(0, 0, 0, 0.45);
}
* {
  box-sizing: border-box;
}
html,
body {
  height: 100%;
}
body {
  margin: 0;
  font-family: Inter, system-ui, "Segoe UI", Roboto, Helvetica, Arial,
    sans-serif;
  background: var(--bg);
  color: var(--text);
}
header {
  height: var(--header-h);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 18px;
  background: var(--brand);
  color: #fff;
  box-shadow: var(--shadow);
  position: sticky;
  top: 0;
  z-index: 1000;
}
.brand {
  display: flex;
  align-items: center;
  gap: 10px;
}
.brand img {
  height: 38px;
  border-radius: 8px;
}
.brand h1 {
  margin: 0;
  font-size: 18px;
  font-weight: 800;
}
.theme-toggle {
  appearance: none;
  border: 1px solid rgba(255, 255, 255, 0.35);
  background: transparent;
  color: #fff;
  padding: 6px 10px;
  border-radius: 10px;
  cursor: pointer;
  font-size: 16px;
  transition: transform 0.12s, background 0.2s;
}
.theme-toggle:hover {
  background: rgba(255, 255, 255, 0.15);
}
.theme-toggle:active {
  transform: scale(0.96);
}
#map {
  height: calc(100vh - var(--header-h));
  width: 100%;
}
.search-wrap {
  position: absolute;
  top: calc(var(--header-h) + 12px);
  left: 50%;
  transform: translateX(-50%);
  z-index: 1001;
  width: min(620px, 92vw);
}
.search {
  display: flex;
  align-items: center;
  gap: 8px;
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 10px 12px;
  box-shadow: var(--shadow);
}
.search input {
  flex: 1;
  border: none;
  outline: none;
  background: transparent;
  color: var(--text);
  font-size: 14px;
}
.search .btn {
  border: none;
  background: var(--chip-bg);
  color: var(--text);
  padding: 8px 10px;
  border-radius: 10px;
  cursor: pointer;
}
.toolbar {
  position: absolute;
  top: calc(var(--header-h) + 64px);
  left: 50%;
  transform: translateX(-50%);
  z-index: 1001;
  display: flex;
  gap: 8px;
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 6px;
  box-shadow: var(--shadow);
}
.chip {
  border: none;
  background: var(--chip-bg);
  color: var(--text);
  padding: 8px 12px;
  border-radius: 999px;
  cursor: pointer;
  font-weight: 700;
  font-size: 14px;
  transition: all 0.2s;
}
.chip:hover {
  filter: brightness(1.05);
}
.chip.active {
  box-shadow: inset 0 0 0 2px var(--brand);
  background: #fff;
}
.timebar {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  bottom: 18px;
  z-index: 1001;
  display: flex;
  align-items: center;
  gap: 10px;
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 10px 12px;
  box-shadow: var(--shadow);
  width: min(720px, 92vw);
}
.timebar .label {
  font-size: 13px;
  color: var(--muted);
  min-width: 130px;
}
.timebar input[type="range"] {
  flex: 1;
}
.timebar .play {
  border: none;
  background: var(--chip-bg);
  color: var(--text);
  padding: 8px 12px;
  border-radius: 10px;
  cursor: pointer;
  font-weight: 800;
}
.leaflet-top.leaflet-left {
  margin-top: 84px;
}
.leaflet-control {
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 8px;
  box-shadow: var(--shadow);
}
.leaflet-bar a {
  color: var(--text);
}
.leaflet-bar a:hover {
  background: var(--brand);
  color: #fff;
}
.leaflet-control-attribution {
  background: rgba(255, 255, 255, 0.8);
  padding: 3px 6px;
  border-radius: 6px;
}
html[data-theme="dark"] .leaflet-control-attribution {
  background: rgba(17, 24, 39, 0.7);
  color: var(--muted);
}
aside#sidebar {
  position: absolute;
  top: calc(var(--header-h) + 10px);
  right: 10px;
  width: 360px;
  max-width: 92vw;
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 16px;
  box-shadow: var(--shadow);
  z-index: 1002;
  padding: 14px;
  display: none;
}
aside#sidebar.open {
  display: block;
  animation: slideIn 0.18s ease;
}
@keyframes slideIn {
  from {
    transform: translateY(6px);
    opacity: 0;
  }
  to {
    transform: none;
    opacity: 1;
  }
}
.sb-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}
.sb-title {
  margin: 0;
  font-size: 16px;
}
.sb-close {
  border: none;
  background: transparent;
  color: var(--muted);
  cursor: pointer;
  font-size: 20px;
}
.stat-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
  margin: 10px 0;
}
.stat {
  background: var(--chip-bg);
  border-radius: 12px;
  padding: 10px;
  border: 1px solid var(--border);
}
.stat .label {
  font-size: 12px;
  color: var(--muted);
}
.stat .value {
  font-size: 20px;
  font-weight: 800;
  margin-top: 4px;
}
footer {
  position: absolute;
  right: 12px;
  bottom: 6px;
  z-index: 1001;
  font-size: 12px;
  color: var(--muted);
  background: rgba(255, 255, 255, 0.85);
  padding: 4px 8px;
  border-radius: 8px;
  border: 1px solid var(--border);
}
html[data-theme="dark"] footer {
  background: rgba(17, 24, 39, 0.7);
}
.legend {
  position: absolute;
  left: 12px;
  bottom: 12px;
  z-index: 1002;
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 8px 10px;
  box-shadow: var(--shadow);
  font-size: 12px;
  color: var(--muted);
}
.legend .bar {
  width: 160px;
  height: 10px;
  border-radius: 999px;
  margin: 6px 0;
  background: linear-gradient(to right, #2b6cb0, #60a5fa, #fbbf24, #ef4444);
}
.legend .labels {
  display: flex;
  justify-content: space-between;
}
/* lu√¥n hi·ªÉn th·ªã legend */
#legend {
  display: block !important;
  visibility: visible !important;
}
@media (max-width: 768px) {
  .toolbar {
    top: calc(var(--header-h) + 58px);
  }
  .leaflet-top.leaflet-left {
    margin-top: 110px;
  }
  .timebar .label {
    display: none;
  }
}
/* Google Places dropdown v√† g·ª£i √Ω t·ª± code n·ªïi tr√™n Leaflet */
.pac-container {
  z-index: 3000 !important;
}
.suggest {
  position: absolute;
  z-index: 3000;
  left: 0;
  right: 0;
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 10px;
  margin-top: 6px;
  box-shadow: var(--shadow);
  max-height: 260px;
  overflow: auto;
}
.suggest div {
  padding: 8px 10px;
  cursor: pointer;
  border-bottom: 1px solid var(--border);
}
.suggest div:hover {
  background: var(--chip-bg);
}
    </style>
    <script src="https://unpkg.com/leaflet-pip/leaflet-pip.min.js"></script>
    <script src="app.js" defer></script>
  </head>
  <body>
    <header>
      <div class="brand">
        <img
          src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/60/Weather_Icon_-_Forecast.png/64px-Weather_Icon_-_Forecast.png"
          alt="logo"
        />
        <h1>Weather Forecast VN</h1>
      </div>
      <button
        id="theme-toggle"
        class="theme-toggle"
        aria-pressed="false"
        title="Chuy·ªÉn ch·∫ø ƒë·ªô t·ªëi"
      >
        üåô
      </button>
    </header>

    <div class="search-wrap">
      <div class="search">
        <button id="btn-search" class="btn" title="T√¨m ki·∫øm">üîç</button>
        <input
          id="pac-input"
          type="text"
          placeholder="Nh·∫≠p ƒë·ªãa ƒëi·ªÉm c·∫ßn t√¨m..."
          aria-label="T√¨m ki·∫øm ƒë·ªãa ƒëi·ªÉm"
        />
        <div id="sg" class="suggest" hidden></div>
        <button id="btn-locate" class="btn" title="V·ªã tr√≠ hi·ªán t·∫°i">üìç</button>
      </div>
    </div>

    <div class="toolbar" role="group" aria-label="L·ªõp hi·ªÉn th·ªã">
      <button class="chip" id="chip-temp">üå° Nhi·ªát ƒë·ªô</button>
      <button class="chip" id="chip-rain">üåß M∆∞a</button>
      <button class="chip" id="chip-wind">üí® Gi√≥</button>
    </div>

    <aside id="sidebar" aria-live="polite">
      <div class="sb-header">
        <h3 class="sb-title">Chi ti·∫øt th·ªùi ti·∫øt</h3>
        <button class="sb-close" id="sb-close" aria-label="ƒê√≥ng">√ó</button>
      </div>
      <div class="stat-grid">
        <div class="stat">
          <div class="label">T·ªça ƒë·ªô</div>
          <div class="value" id="sb-coord">-- , --</div>
        </div>
        <div class="stat">
          <div class="label">Nhi·ªát ƒë·ªô</div>
          <div class="value" id="sb-temp">-- ¬∞C</div>
        </div>
        <div class="stat">
          <div class="label">M∆∞a</div>
          <div class="value" id="sb-rain">-- mm</div>
        </div>
        <div class="stat">
          <div class="label">Gi√≥</div>
          <div class="value" id="sb-wind">-- m/s</div>
        </div>
        <div class="stat">
          <div class="label">ƒê·ªô ·∫©m</div>
          <div class="value" id="sb-hum">-- %</div>
        </div>
      </div>
      <small class="muted">Ngu·ªìn: /api/obs/latest.</small>
    </aside>

    <div id="map"></div>

    <div class="timebar" aria-label="Thanh th·ªùi gian">
      <div class="label" id="time-label">Hi·ªán t·∫°i</div>
      <input
        id="time-range"
        type="range"
        min="0"
        max="23"
        step="1"
        value="12"
      />
      <button id="btn-play" class="play" aria-pressed="false">‚ñ∂Ô∏è</button>
    </div>
    <!-- legend nhi·ªát ƒë·ªô tƒ©nh -->
    <!-- ƒë·∫∑t ·ªü g√≥c tr√°i d∆∞·ªõi nh∆∞ b·∫°n ƒëang c√≥ -->
    <div id="legend-temp" class="legend">
      <div class="title">Ch·ªâ s·ªë (¬∞C)</div>
      <div class="bar"></div>
      <div class="ticks"><span>Th·∫•p</span><span>Cao</span></div>
    </div>


    <footer>Ngu·ªìn: OpenStreetMap ¬∑ CARTO ¬∑ Google</footer>
  </body>
  
</html>
